<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>5.17. ゴールド銀行</title>
    <link rel="stylesheet" type="text/css" href="dqbook.css" />
    <meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" />
    <link rel="home" href="index.html" title="ドラクエ命" />
    <link rel="up" href="dq3.html" title="第 5 章 SFC 版ドラクエ 3 (1996)" />
    <link rel="prev" href="dq3_registration.html" title="5.16. 冒険者たちの登録所" />
    <link rel="next" href="dq3_dharma.html" title="5.18. 転職" />
  </head>
  <body>
    <div class="navigation"><table><tr><td class="online-navigation"><a href="dq3_registration.html" title="5.16. 冒険者たちの登録所"><img src="image/docbook/prev.png" alt="戻る" /></a></td><td class="online-navigation"><a href="dq3.html" title="第 5 章 SFC 版ドラクエ 3 (1996)"><img src="image/docbook/up.png" alt="上に戻る" /></a></td><td class="online-navigation"><a href="dq3_dharma.html" title="5.18. 転職"><img src="image/docbook/next.png" alt="次へ" /></a></td><td>ドラクエ命</td><td class="online-navigation"><a href="index.html" title="ドラクエ命"><img src="image/docbook/home.png" alt="ホーム" /></a></td><td class="online-navigation"><a href="" title=""><img src="image/docbook/index.png" alt="索引" /></a></td></tr></table><b class="navlabel">Previous: </b><a accesskey="p" class="sectref" href="dq3_registration.html">5.16. 冒険者たちの登録所</a> <b class="navlabel">Up: </b><a accesskey="u" class="sectref" href="dq3.html">第 5 章 SFC 版ドラクエ 3 (1996)</a> <b class="navlabel">Next: </b><a accesskey="n" class="sectref" href="dq3_dharma.html">5.18. 転職</a><hr /></div>
    <div class="section">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title" style="clear: both"><a id="dq3.bank"></a>5.17. ゴールド銀行</h2>
          </div>
        </div>
      </div>
      <div class="toc">
        <dl class="toc">
          <dt>
            <span class="section">
              <a href="dq3_bank.html#dq3.bank.structure">5.17.1. 構造に関する構成要素</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="dq3_bank.html#dq3.bank.behavior">5.17.2. 振る舞いに関する構成要素</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="dq3_bank.html#dq3.bank.behavior.C3E2F2">5.17.2.1. サブルーチン <code class="varname">$C3E2F2</code>: ゴールド銀行メイン</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="dq3_bank.html#dq3.bank.behavior.C3E39E">5.17.2.2. サブルーチン <code class="varname">$C3E39E</code>: あずける</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="dq3_bank.html#dq3.bank.behavior.C3E410">5.17.2.3. サブルーチン <code class="varname">$C3E410</code>: ひきだす</a>
                </span>
              </dt>
            </dl>
          </dd>
        </dl>
      </div>
      <p>
本節ではゴールド銀行について述べる。
</p>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h3 class="title"><a id="dq3.bank.structure"></a>5.17.1. 構造に関する構成要素</h3>
            </div>
          </div>
        </div>
        <p>
ゴールド銀行については、大規模なデータが存在しない。
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h3 class="title"><a id="dq3.bank.behavior"></a>5.17.2. 振る舞いに関する構成要素</h3>
            </div>
          </div>
        </div>
        <p>
ゴールド銀行の振る舞いに関する構成要素、つまり窓口処理について述べる。
</p>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title"><a id="dq3.bank.behavior.C3E2F2"></a>5.17.2.1. サブルーチン <code class="varname">$C3E2F2</code>: ゴールド銀行メイン</h4>
              </div>
            </div>
          </div>
          <p>
サブルーチン <code class="varname">$C3E2F2</code> は、銀行の窓口に「はなす」とすぐに開始される処理である。
以下に要点を挙げる。
</p>
          <div class="itemizedlist">
            <ul class="itemizedlist" style="list-style-type: disc; ">
              <li class="listitem">
                <p>
      挨拶で、係員がサービスの説明を初回しかしないように、フラグ<code class="varname">$7E353C</code> &amp; <code class="literal">#$02</code> を用いる。
    </p>
              </li>
              <li class="listitem">
                <p>
      初回でない場合には、預金残高を伝える。預金残高がゼロか否かで台詞を変える。
    </p>
              </li>
              <li class="listitem">
                <p>
      サービスは「あずける」と「ひきだす」がある。どちらも後述するサブルーチンそれぞれが処理する。
    </p>
              </li>
              <li class="listitem">
                <p>
      取引を終えた後、係員が預金残高を伝えて終了する。残高がゼロか否かで台詞を変える。
    </p>
              </li>
            </ul>
          </div>
          <p>
これらの台詞のテキストを見れば、メモリ内に管理されている預金が本当に千単位であることが推察できる。
</p>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title"><a id="dq3.bank.behavior.C3E39E"></a>5.17.2.2. サブルーチン <code class="varname">$C3E39E</code>: あずける</h4>
              </div>
            </div>
          </div>
          <p>
「あずける」を選択したときの処理はサブルーチン <code class="varname">$C3E39E</code> に定義されている。
以下に要点を挙げる。
</p>
          <div class="itemizedlist">
            <ul class="itemizedlist" style="list-style-type: disc; ">
              <li class="listitem">
                <p>
      サブルーチン <code class="varname">$C45BBA</code> で残高金額をチェックする。
      このとき、メモリ内預金額が 10,000 以上の値になっていると、
      係員はさらなる預金を断る。
    </p>
              </li>
              <li class="listitem">
                <p>
      サブルーチン <code class="varname">$C45BEB</code> で預金をする。これは増加分だけを指定する。
      この結果、初めて預金額更新が成功したかどうかがわかるので、それに応じて振る舞いが変わる。
    </p>
                <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: circle; ">
                    <li class="listitem">
                      <p>
          入力金額が金庫の限界を超えることがわかったときには、
          まず<code class="code">9,999 - メモリ内預金額</code> を計算する。
          それから係員が入金可能金額の上限としてこの結果を伝えて、処理を金額入力まで戻す。
        </p>
                    </li>
                    <li class="listitem">
                      <p>
          入力金額がパーティーの所持金を越えるときには、
          係員が「失礼ですが～」と断り、処理を金額入力まで戻す。
        </p>
                    </li>
                  </ul>
                </div>
              </li>
              <li class="listitem">
                <p>
      預金が成功すれば、この手続きを終了する。
    </p>
              </li>
            </ul>
          </div>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title"><a id="dq3.bank.behavior.C3E410"></a>5.17.2.3. サブルーチン <code class="varname">$C3E410</code>: ひきだす</h4>
              </div>
            </div>
          </div>
          <p>
「ひきだす」を選択したときの処理はサブルーチン <code class="varname">$C3E410</code> に定義されている。
以下に要点を挙げる。
</p>
          <div class="itemizedlist">
            <ul class="itemizedlist" style="list-style-type: disc; ">
              <li class="listitem">
                <p>
      汎用サブルーチン <code class="varname">$C45BBA</code> で残高金額を得る。
      値がゼロの場合は係員が台詞を言って手続きを打ち切る。
    </p>
              </li>
              <li class="listitem">
                <p>
      入力金額がゼロでない場合、
      入力金額、パーティーの所持金、預金残高をサブルーチン <code class="varname">$C45C5A</code> で比較する。
      所持金総額がその上限を超えないような場合、
      係員が引き出し額を確認して取引成立となる。
    </p>
                <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: circle; ">
                    <li class="listitem">
                      <p>
          入力金額が預金残高以下ではあるが、
          引き出したい金額をパーティの所持金に加算すると所持可能金額上限を超えるときには、
          係員が多過ぎると言って、引き出し手続きを最初まで戻す。
        </p>
                    </li>
                    <li class="listitem">
                      <p>
          すなわち入力金額が預金残高を越える値であるときには、
          係員が預かっていないと言って、引き出し手続きを最初まで戻す。
        </p>
                    </li>
                  </ul>
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="navigation"><hr /><table><tr><td class="online-navigation"><a href="dq3_registration.html" title="5.16. 冒険者たちの登録所"><img src="image/docbook/prev.png" alt="戻る" /></a></td><td class="online-navigation"><a href="dq3.html" title="第 5 章 SFC 版ドラクエ 3 (1996)"><img src="image/docbook/up.png" alt="上に戻る" /></a></td><td class="online-navigation"><a href="dq3_dharma.html" title="5.18. 転職"><img src="image/docbook/next.png" alt="次へ" /></a></td><td>ドラクエ命</td><td class="online-navigation"><a href="index.html" title="ドラクエ命"><img src="image/docbook/home.png" alt="ホーム" /></a></td><td class="online-navigation"><a href="" title=""><img src="image/docbook/index.png" alt="索引" /></a></td></tr></table><b class="navlabel">Previous: </b><a accesskey="p" class="sectref" href="dq3_registration.html">5.16. 冒険者たちの登録所</a> <b class="navlabel">Up: </b><a accesskey="u" class="sectref" href="dq3.html">第 5 章 SFC 版ドラクエ 3 (1996)</a> <b class="navlabel">Next: </b><a accesskey="n" class="sectref" href="dq3_dharma.html">5.18. 転職</a></div>
  </body>
</html>

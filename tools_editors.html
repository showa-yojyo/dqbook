<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>2.4. エディタ</title>
    <link rel="stylesheet" type="text/css" href="dqbook.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="home" href="index.html" title="ドラクエ命" />
    <link rel="up" href="tools.html" title="第 2 章 解析ツール" />
    <link rel="prev" href="tools_cygwin.html" title="2.3. Cygwin" />
    <link rel="next" href="tools_python.html" title="2.5. Python" />
  </head>
  <body>
    <div class="navigation"><table><tr><td class="online-navigation"><a href="tools_cygwin.html" title="2.3. Cygwin"><img src="image/docbook/prev.png" alt="戻る" /></a></td><td class="online-navigation"><a href="tools.html" title="第 2 章 解析ツール"><img src="image/docbook/up.png" alt="上に戻る" /></a></td><td class="online-navigation"><a href="tools_python.html" title="2.5. Python"><img src="image/docbook/next.png" alt="次へ" /></a></td><td>ドラクエ命</td><td class="online-navigation"><a href="index.html" title="ドラクエ命"><img src="image/docbook/home.png" alt="ホーム" /></a></td><td class="online-navigation"><a href="" title=""><img src="image/docbook/index.png" alt="索引" /></a></td></tr></table><b class="navlabel">Previous: </b><a accesskey="p" class="sectref" href="tools_cygwin.html">2.3. Cygwin</a> <b class="navlabel">Up: </b><a accesskey="u" class="sectref" href="tools.html">第 2 章 解析ツール</a> <b class="navlabel">Next: </b><a accesskey="n" class="sectref" href="tools_python.html">2.5. Python</a><hr /></div>
    <div class="section">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title" style="clear: both"><a id="tools.editors"></a>2.4. エディタ</h2>
          </div>
        </div>
      </div>
      <div class="toc">
        <dl class="toc">
          <dt>
            <span class="section">
              <a href="tools_editors.html#tools.editors.xyzzy">2.4.1. Xyzzy</a>
            </span>
          </dt>
          <dt>
            <span class="section">
              <a href="tools_editors.html#tools.editors.stirling">2.4.2. Stirling</a>
            </span>
          </dt>
        </dl>
      </div>
      <p>
エディタとは通常はテキストに対するそれを指す。
バイナリエディタの話題をする場合には、「バイナリ」を省略せずに記す。
</p>
      <p>
記者の場合、巨大な逆アセンブリコードを、バンク単位ごとにテキストファイルとして保存しておくのが、
逆解析作業の最初の一歩となる。
例えば、戦闘ロジックを調べたいとしよう。
このとき、まずは戦闘ロジックのサブルーチンを含むバンクの逆アセンブリコードファイルをテキストエディタで開く。
同時に、戦闘にも関係するようなゲーム全般から参照されるサブルーチンのあるバンク、
さらに汎用的な目的で利用されるライブラリ的なサブルーチンを含むバンクの各コードファイルも開いている必要がある。
そういうふうにしてサブルーチンの呼び出し関係を追っていかないと、制御の構造がつかめない。
要するに、複数のファイルを同時に開くことができて、かつ頻繁にそれらの間を行ったり来たりする機能があるエディタでないと、
解析作業に支障をきたす（記者個人的には）。
</p>
      <p>
逆解析作業に相応しいエディタに要求する機能を列挙する。これらは要件だと考えてもいい。
これらを大体満足するエディタをまず見つけ、確保してから、
逆アセンブリコード解析作業を始めるのが望ましい。
自分の好みに合ったエディタを求めて、インターネットを何ヶ月でもさまよう覚悟が欲しい。
それほどエディタ選択は重要だ。
</p>
      <p>
バイナリエディタに関しては、それほど高機能な要件を課さない。
というのも、バイナリエディタを用いて行う作業がそれほど多くはないからだ。
以下のもので十分だろう。
</p>
      <div class="variablelist">
        <dl class="variablelist">
          <dt>
            <span class="term">複数回 Undo/Redo 機能</span>
          </dt>
          <dd>
            <p>
        ロムイメージを不用意に変更した場合、オリジナルの状態にまで復元できることが大前提となる。
        もっと言うと、復元時点でそのことが視覚的に確認できるとよい。
      </p>
          </dd>
          <dt>
            <span class="term">検索機能</span>
          </dt>
          <dd>
            <p>
        開いたファイルの中からバイト列パターンを指定して検索し、
        それが見つかればそのアドレスへジャンプするような機能と、
        <span class="command"><strong>grep</strong></span> のように、特定のフォルダから同様に検索し、
        ファイル名と検出したアドレスのすべてを一覧表示する機能が要る。
        ここでは後者の機能を BGREP と呼ぶことにする。
      </p>
          </dd>
          <dt>
            <span class="term">軽さ</span>
          </dt>
          <dd>
            <p>
        例えば CD-ROM に収めてある巨大なデータファイルを開いても、
        スクロールバーが滑らかに動くことを強く勧める。
        そうでなければ、作業にならない。
      </p>
          </dd>
        </dl>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h3 class="title"><a id="tools.editors.xyzzy"></a>2.4.1. Xyzzy</h3>
            </div>
          </div>
        </div>
        <a id="term.editors" class="indexterm"></a>
        <div class="figure">
          <a id="fig.dq.hack.tool.xyzzy"></a>
          <p class="title">
            <strong>図 2.7 Xyzzy</strong>
          </p>
          <div class="figure-contents">
            <div>
              <table border="0" summary="manufactured viewport for HTML img" style="cellpadding: 0; cellspacing: 0;" width="578">
                <tr>
                  <td>
                    <img src="./image/tools.editors.xyzzy.png" width="578" alt="Xyzzy" />
                  </td>
                </tr>
              </table>
            </div>
          </div>
        </div>
        <br class="figure-break" />
        <p>
あえて一言で表現すれば、Windows 環境で起動するテキストエディタである。
本説を執筆した当時は作者の Web サイト
<a class="ulink" href="http://www.jsdlab.co.jp/~kamei/" target="_top">やる気のない謎のぺぇじ</a>
で入手可能であったが、現在は <a class="ulink" href="http://xyzzy-022.github.io/" target="_top">xyzzy-022.github.io</a> で入手するのがよい。
</p>
      </div>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h3 class="title"><a id="tools.editors.stirling"></a>2.4.2. Stirling</h3>
            </div>
          </div>
        </div>
        <a id="term.stirling" class="indexterm"></a>
        <a id="term.hexeditor" class="indexterm"></a>
        <p>
Stirling はフリーのバイナリエディタである。README には
<a class="ulink" href="http://www2c.airnet.ne.jp/dds2" target="_top">http://www2c.airnet.ne.jp/dds2</a> から入手可能とあるようだが、
記者は Vector あたりから入手した記憶がある。
このバイナリエディタの特徴は色々あるが、
個人的には複数回 Undo/Redo 機能が完璧に実装されているのがうれしかった。
</p>
        <p>
記者は逆アセンブルを知らない時代に、ロムイメージファイル内のデータとおぼしき部位を改造し、
エミュレータで動作の変更を見るといった、偶発的な解析を行うのに用いていた。
当然現在ではそのような利用はしていない。BGREP の機能を主に活用している。
例えば、特定のサブルーチンを呼び出す箇所をすべて特定することができる。
</p>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note">
            <tr>
              <td rowspan="2" align="center" valign="top" width="25">
                <img alt="[注記]" src="image/docbook/note.png" />
              </td>
              <th align="left">注記</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>
    現在では上で紹介したもの以外にも高機能な無料のバイナリーエディターが存在すると思われる。
    Google で hex editor のような単語を組み合わせて検索すれば、比較的容易に優良なツールを発見できるのではないだろうか。
  </p>
                <p>
    実はバイナリーエディターはコード解析の観点からはそれほど重要なツールではない。
    コマンドラインで <span class="command"><strong>od</strong></span> や <span class="command"><strong>hexdump</strong></span> を利用して ROM イメージを十六進ダンプすることで間に合うことが多い。
    BGREP は少々コーディングの手間を要するが、Python の正規表現パターンを <span class="type">bytes</span> オブジェクトで構築することで実現可能だ。
    とりわけスーパーファミコンの ROM を作業する上では各種アドレス変換が面倒なことから、
    逆アセンブラーを自作する過程で自ずと出来上がる機能を流用して、ダンプツールや BGREP を実装するのが当然の手段になる。
  </p>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>
    <div class="navigation"><hr /><table><tr><td class="online-navigation"><a href="tools_cygwin.html" title="2.3. Cygwin"><img src="image/docbook/prev.png" alt="戻る" /></a></td><td class="online-navigation"><a href="tools.html" title="第 2 章 解析ツール"><img src="image/docbook/up.png" alt="上に戻る" /></a></td><td class="online-navigation"><a href="tools_python.html" title="2.5. Python"><img src="image/docbook/next.png" alt="次へ" /></a></td><td>ドラクエ命</td><td class="online-navigation"><a href="index.html" title="ドラクエ命"><img src="image/docbook/home.png" alt="ホーム" /></a></td><td class="online-navigation"><a href="" title=""><img src="image/docbook/index.png" alt="索引" /></a></td></tr></table><b class="navlabel">Previous: </b><a accesskey="p" class="sectref" href="tools_cygwin.html">2.3. Cygwin</a> <b class="navlabel">Up: </b><a accesskey="u" class="sectref" href="tools.html">第 2 章 解析ツール</a> <b class="navlabel">Next: </b><a accesskey="n" class="sectref" href="tools_python.html">2.5. Python</a></div>
  </body>
</html>

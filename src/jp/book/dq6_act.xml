<?xml version="1.0" encoding="UTF-8"?>

<section id="dq6.act"><?dbhtml filename="dq6_act.html" ?>
<title>戦闘行動解析</title>
<indexterm id="term.dq6.act"><primary>行動</primary><secondary>DQ6</secondary></indexterm>
<para>
	この文書では、<varname>$C8C65D</varname> に定義されている戦闘行動構造体の解析をどのようにして行うのかを説明する。
	先人の手で「戦闘行動構造体データが <varname>$C8C65D</varname> に存在する」ことが判明している。
	これを出発点に、どこまで構造体の仕組みを解明できるかに挑戦する。
</para>
<para>
	以下のことは、解析前に既知であると仮定する。
</para>
<itemizedlist>
	<listitem>
		<para>
			戦闘行動構造体データが <varname>$C8C65D</varname> に存在する
		</para>
	</listitem>
	<listitem>
		<para>
			行動データの個数は <literal>#$019A</literal> である
		</para>
	</listitem>
</itemizedlist>

<section id="dq6.act.hack">
<title>解析</title>
<para>
	<link linkend="dq6.item">アイテム解析</link> のときと同じ戦略をとった。
	以下、戦闘行動構造体のメンバー取得サブルーチンの紹介をする。
</para>

<section id="dq6.act.hack.C8EE67">
<title><varname>$C8EE67</varname> - 戦闘行動構造体へのポインタ配列</title>
<para>
	<link linkend="dq6.item.hack.C41A3D">アイテム構造体へのポインタ配列</link>と同じ役割を果たす。
	格納されているデータは、戦闘行動 ID に対応するアイテムデータが格納されているアドレスだ。
	ただし、この値を <literal>#$C8C65D</literal> に加算したものが正確なアドレスだ。
</para>
<programlisting>
C8/EE67:    0000 // 0000 [表示なし]
C8/EE69:    1900 // 0001 メラ
C8/EE6B:    3200 // 0002 メラミ
C8/EE6D:    4B00 // 0003 メラゾーマ
C8/EE6F:    6400 // 0004 ギラ
C8/EE71:    7D00 // 0005 べギラマ
C8/EE73:    9600 // 0006 べギラゴン
C8/EE75:    AF00 // 0007 イオ
C8/EE77:    C800 // 0008 イオラ
C8/EE79:    E100 // 0009 イオナズン
...
</programlisting>
<para>
	例えば、以下のようにして戦闘行動 <varname>X</varname> のデータ内部の値を取得する実装がある。
	<code>LDA $C8EE67,X</code> を逆アセンブルコードファイルから <command>grep</command> すれば、
	つられて <code>LDA $C8C6??,X</code> タイプのコードが見つかる。
	その周囲を解読して、戦闘行動構造体のレイアウトを解析する。
</para>
<programlisting>
C2/8BD2:    AD8D25      LDA $258D           // 行動 ID
C2/8BD5:    0A          ASL A
C2/8BD6:    AA          TAX 
C2/8BD7:    BF67EEC8    LDA $C8EE67,X       // 行動構造体へのポインタ
C2/8BDB:    AA          TAX 
C2/8BDC:    BF62C6C8    LDA $C8C662,X       // 耐性
C2/8BE0:    291F00      AND #$001F          a = 行動X[05h] &amp; 001Fh;
C2/8BE3:    C91F00      CMP #$001F
...
</programlisting>
</section> <!-- dq6.act.hack.C8EE67 -->

<section id="dq6.act.hack.C2F0C2">
<title><code>JSL $C2F0C2</code> によるデータ取得</title>
<para>
	<varname>X</varname> を戦闘行動 ID にセットした直後に呼び出し、
	さらに構造体のアドレスを <literal>2</literal> バイトの「実引数」を指定してから、
	そこに格納されている値をアキュームレータにロードするサブルーチンの呼び出しだ。
</para>
<para>
	ここでは紙面の都合上、各種データ取得サブルーチンのコードを紹介できない。
	呼び出し元だけをお見せすると、
	下の例は、アドレス <literal>C8C674 + sizeof(戦闘行動構造体) * x</literal> から値を取得するものだ。
</para>
<programlisting>
C3/9C9F:    AA          TAX 
C3/9CA0:    22C2F0C2    JSR $C2F0C2         ■(RTL+2)
            74C6        // 呪文名文字列 ID
C3/9CA6:    223A76C3    JSR $C3763A         ■a を ID とする文字列を描画
</programlisting>
</section> <!-- dq6.act.hack.C2F0C2 -->

<section id="dq6.act.hack.C2F0C9">
<title><code>JSL $C2F0C9</code> によるデータ取得</title>
<para>
	<link linkend="dq6.act.hack.C2F0C2"><code>JSL $C2F0C2</code> によるデータ取得</link>の Y バージョンだ。
</para>
</section> <!-- dq6.act.hack.C2F0C9 -->

<section id="dq6.act.hack.C2F0DF">
<title><code>JSL $C2F0DF</code> によるデータ取得</title>
<para>
	<varname>X</varname> を戦闘行動 ID にセットした直後に呼び出し、
	さらに構造体のアドレスを <literal>4</literal> バイトの「実引数」を指定してから、
	そこに格納されている値をアキュームレータにロードするサブルーチンの呼び出しだ。
	<literal>4</literal> バイトの内訳は、最初の <literal>2</literal> バイトが構造体内部のどこかを指すアドレスであり、
	最後の <literal>2</literal> バイトがビットマスクだ。
	マスク後、それを右シフトして数値化したものをアキュームレータにロードする。
</para>
<para>
	一つ例を挙げる。
	下の呼び出しにおいて、サブルーチンの呼び出しはアドレス
	<literal>C8C667 + sizeof(戦闘行動構造体) * x</literal> にある <literal>2</literal> バイトの値に対し、
	<literal>#$0040</literal> の「桁」だけを取り出すものだ。
</para>
<programlisting>
C2/6208:    AE5F25      LDX $255F           // 行動 ID
C2/620B:    22DFF0C2    JSR $C2F0DF         ■(RTL+4)
            67C6
            4000    // 戦闘メッセージを表示するか否か
C2/6213:    D01C        BNE $6231
</programlisting>
</section> <!-- dq6.act.hack.C2F0DF -->

<section id="dq6.act.hack.C2F0E6">
<title><code>JSL $C2F0E6</code> によるデータ取得</title>
<para>
	<link linkend="dq6.act.hack.C2F0DF"><code>JSL $C2F0DF</code> によるデータ取得</link>の <varname>Y</varname> バージョンだ。
</para>
</section> <!-- dq6.act.hack.C2F0E6 -->

<section id="dq6.act.hack.C2F0FC">
<title><code>JSL $C2F0FC</code> によるデータ取得</title>
<para>
	サブルーチン <varname>$C2F0FC</varname> は、
	<link linkend="dq6.act.hack.C2F0DF">サブルーチン <varname>$C2F0DF</varname></link>
	とまったく同じ実装だ。
	従って、同じ役割を果たすわけだが、
	なぜ本物が二つあるのかは不明。
</para>
</section> <!-- dq6.act.hack.C2F0FC -->

<section id="dq6.act.hack.C2F103">
<title><code>JSL $C2F103</code> によるデータ取得</title>
<para>
	<link linkend="dq6.act.hack.C2F0DF"><code>JSL $C2F0FC</code> によるデータ取得</link>の <varname>Y</varname> バージョンだ。
	取りも直さず <link linkend="dq6.act.hack.C2F0E6"><varname>$C2F0E6</varname></link>
	と同じ実装だ。
</para>
</section> <!-- dq6.act.hack.C2F103 -->

<section id="dq6.act.hack.C8C65D">
<title><varname>$C8C65D</varname> - 戦闘行動構造体</title>
<para>
	構造体一個あたりのデータ格納レイアウトを以下に示す。
	括弧内の数字はバイト数またはビット数（小数点以下）を示す。
</para>

<table id="table.dq6.C8C65D" class="memorylayout">
	<caption>$C8C65D 戦闘行動構造体</caption>
	<colgroup>
		<col span="1" width="12%"/>
		<col span="7" width="11%"/>
	</colgroup>
	<thead>
		<tr><th>Byte:Bit</th>
			<th>80</th>
			<th>40</th>
			<th>20</th>
			<th>10</th>
			<th>08</th>
			<th>04</th>
			<th>02</th>
			<th>01</th>
		</tr>
	</thead>
	<tbody>
		<tr><th>00</th>
			<td colspan="7"><code>JSR ($469F,X)</code> のためのインデックス (.7)</td>
			<td colspan="1">呪文フラグ (<literal>.1</literal>)</td>
		</tr>
		<tr><th>01</th>
			<td colspan="7"><code>JSR ($469F,X)</code> のためのインデックス (<literal>.7</literal>)</td>
			<td colspan="1">おどりフラグ (<literal>.1</literal>)</td>
		</tr>
		<tr><th>02</th>
			<td colspan="7"><code>JSR ($469F,X)</code> のためのインデックス (<literal>.7</literal>)</td>
			<td colspan="1">フバーハフラグ (<literal>.1</literal>)</td>
		</tr>
		<tr><th>03</th>
			<td colspan="1">だいぼうぎょフラグ (<literal>.1</literal>)</td>
			<td colspan="1">マヌーサ系フラグ (<literal>.1</literal>)</td>
			<td colspan="6">? (<literal>.6</literal>)</td>
		</tr>
		<tr><th>04</th>
			<td colspan="1">? (<literal>.1</literal>)</td>
			<td colspan="1">痛恨・会心の一撃 (<literal>.1</literal>)</td>
			<td colspan="1">バイキルト (<literal>.1</literal>)</td>
			<td colspan="1">ちから・きあいため (<literal>.1</literal>)</td>
			<td colspan="1">かわす・うちはらう (<literal>.1</literal>)</td>
			<td colspan="3">? (<literal>.3</literal>)</td>
		</tr>
		<tr><th>05</th>
			<td colspan="1">ドラゴンキラー等 (<literal>.1</literal>)</td>
			<td colspan="1">対象が複数 (<literal>.1</literal>)</td>
			<td colspan="1">まじんのかなづち (<literal>.1</literal>)</td>
			<td colspan="5">耐性種別 (<literal>.5</literal>)</td>
		</tr>
		<tr><th>06</th>
			<td colspan="1">? (<literal>.1</literal>)</td>
			<td colspan="1">きせきのつるぎ (<literal>.1</literal>)</td>
			<td colspan="1">追加ダメージのある武器 (<literal>.1</literal>)</td>
			<td colspan="1">はやぶさのけん等 (<literal>.1</literal>)</td>
			<td colspan="1">特殊武器装備時 (<literal>.1</literal>)</td>
			<td colspan="1">どくばり (<literal>.1</literal>)</td>
			<td colspan="2">? (<literal>.2</literal>)</td>
		</tr>
		<tr><th>07</th>
			<td colspan="1">うけながし可能 (<literal>.1</literal>)</td>
			<td colspan="1">マホカンタ等 (<literal>.1</literal>)</td>
			<td colspan="1">かばうことが可能 (<literal>.1</literal>)</td>
			<td colspan="1">アストロン (<literal>.1</literal>)</td>
			<td colspan="1">パラディン時に即死 (<literal>.1</literal>)</td>
			<td colspan="1">? (<literal>.1</literal>)</td>
			<td colspan="2">? (<literal>.2</literal>)</td>
		</tr>
		<tr><th>08</th>
			<td colspan="1">? (<literal>.1</literal>)</td>
			<td colspan="2">メッセージ調整 (<literal>.2</literal>)</td>
			<td colspan="2">まねまねメッセージ (<literal>.2</literal>)</td>
			<td colspan="3">? (<literal>.3</literal>)</td>
		</tr>
		<tr><th>09</th>
			<td colspan="2">? (<literal>.2</literal>)</td>
			<td colspan="6"><code>JSR ($E0D6,X)</code> のためのインデックス (<literal>.6</literal>)</td>
		</tr>
		<tr><th>0A</th>
			<td colspan="1">状態異常クリア (<literal>.1</literal>)</td>
			<td colspan="1">名前を持つか (<literal>.1</literal>)</td>
			<td colspan="6"><code>JSR ($D3E5,X)</code> のためのインデックス (<literal>.6</literal>)</td>
		</tr>
		<tr><th>0B</th>
			<td colspan="1">? (<literal>.1</literal>)</td>
			<td colspan="7"><varname>$C8FC9B</varname> ダメージ構造体へのインデックス (<literal>.7</literal>)</td>
		</tr>
		<tr><th>0C</th>
			<td colspan="8">戦闘行動キャプションセット ID (<literal>1</literal>)</td>
		</tr>
		<tr><th>0D</th>
			<td colspan="8">戦闘行動画面効果 ID (<literal>1</literal>)</td>
		</tr>
		<tr><th>0E</th>
			<td colspan="8">（次のバイトの下位へ続く）</td>
		</tr>
		<tr><th>0F</th>
			<td colspan="1">敵を倒しても無利益 (<literal>.1</literal>)</td>
			<td colspan="7">? (<literal>1.7</literal>)</td>
		</tr>
		<tr><th>10</th>
			<td colspan="2">（次のバイトの下位へ続く）</td>
			<td colspan="4">? (<literal>.4</literal>)</td>
			<td colspan="2">? (<literal>.2</literal>)</td>
		</tr>
		<tr><th>11</th>
			<td colspan="8">? (<literal>1.1</literal>)</td>
		</tr>
		<tr><th>12</th>
			<td rowspan="3" colspan="8">処理サブルーチン アドレス (<literal>3</literal>)</td>
		</tr>
		<tr><th>13</th></tr>
		<tr><th>14</th></tr>
		<tr><th>15</th>
			<td rowspan="2" colspan="8">戦闘メッセージ ID (<literal>2</literal>)</td>
		</tr>
		<tr><th>16</th></tr>
		<tr><th>17</th>
			<td rowspan="2" colspan="8">戦闘行動の名前 文字列 ID (<literal>2</literal>)</td>
		</tr>
		<tr><th>18</th></tr>
	</tbody>
</table>
<para>
	残念ながら全てを解析できていない。
</para>
<para>
	メンバーには勝手に名前をつけておいた。
	以下、その説明をする。
</para>
<glosslist>
	<glossentry>
		<glossterm>呪文フラグ</glossterm>
		<glossdef>
			<para>
				呪文である行動には <literal>1</literal> がセットされている。
				それ以外は <literal>0</literal> がセットされている。
				レベル・職業レベルアップ時に何かを習得する場合、
				それが呪文か特技かを区別するためにも用いられる。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>おどりフラグ</glossterm>
		<glossdef>
			<para>
				「おどりふうじ」の対象となる行動には <literal>1</literal> がセットされている。
				「おどりふうじ」の処理時に参照される。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>フバーハフラグ</glossterm>
		<glossdef>
			<para>
				このメンバーが <literal>1</literal> にセットされている行動は、
				「フバーハ」が効いているキャラクターには、ダメージが半減する。
				また、「おいかぜ」も効き目がある。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>マヌーサ系フラグ</glossterm>
		<glossdef>
			<para>
				マヌーサ系状態のキャラクターがこの行動をするとき、
				攻撃ミスをする処理が有効になるのであれば <literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>だいぼうぎょフラグ</glossterm>
		<glossdef>
			<para>
				「だいぼうぎょ」をするキャラクターに対して、
				ダメージを <literal>1/10</literal> に減じることができるものは <literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>かわす・うちはらうフラグ</glossterm>
		<glossdef>
			<para>
				みをかわすことがあったり、バトルマスターがうちはらうことがある行動には
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>ちからため・きあいためフラグ</glossterm>
		<glossdef>
			<para>
				「ちからため」「きあいため」の直後にこの行動をとれば、
				相手側へのダメージが <literal>1.5</literal> 倍になるものについて、
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>バイキルトフラグ</glossterm>
		<glossdef>
			<para>
				「バイキルト」がかかっている状態でこの行動をとったときに、
				相手側へのダメージが <literal>2</literal> 倍になるものについて、
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>痛恨・会心フラグ</glossterm>
		<glossdef>
			<para>
				痛恨の一撃、または会心の一撃に変化し得る行動について、
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>耐性種別</glossterm>
		<glossdef>
			<para>
				この行動の持つ耐性の種別だ。
				数値と意味の対応は次の通り。
			</para>
			<table id="table.dq6.C8C65D.immunity" class="lighttable">
				<caption>耐性表</caption>
				<thead>
					<tr><th>値</th><th>属性</th></tr>
				</thead>
				<tbody>
					<tr><td><literal>00</literal></td><td>メラ系</td></tr>
					<tr><td><literal>01</literal></td><td>ギラ系</td></tr>
					<tr><td><literal>02</literal></td><td>イオ系</td></tr>
					<tr><td><literal>03</literal></td><td>ヒャド系</td></tr>
					<tr><td><literal>04</literal></td><td>バギ系</td></tr>
					<tr><td><literal>05</literal></td><td>デイン系</td></tr>
					<tr><td><literal>06</literal></td><td>マヌーサ系</td></tr>
					<tr><td><literal>07</literal></td><td>ラリホー系</td></tr>
					<tr><td><literal>08</literal></td><td>ザキ系</td></tr>
					<tr><td><literal>09</literal></td><td>ニフラム・バシルーラ</td></tr>
					<tr><td><literal>0A</literal></td><td>マホトラ系</td></tr>
					<tr><td><literal>0B</literal></td><td>マホトーン系</td></tr>
					<tr><td><literal>0C</literal></td><td>メダパニ系</td></tr>
					<tr><td><literal>0D</literal></td><td>ルカニ系</td></tr>
					<tr><td><literal>0E</literal></td><td>該当なし</td></tr>
					<tr><td><literal>0F</literal></td><td>毒系</td></tr>
					<tr><td><literal>10</literal></td><td>やすみ系</td></tr>
					<tr><td><literal>11</literal></td><td>おどりふうじ</td></tr>
					<tr><td><literal>12</literal></td><td>かえん系</td></tr>
					<tr><td><literal>13</literal></td><td>ふぶき系</td></tr>
					<tr><td><literal>14</literal></td><td>たたき系</td></tr>
					<tr><td><literal>15</literal></td><td>マヒ系</td></tr>
					<tr><td><literal>16</literal></td><td>ぐんたいよび</td></tr>
					<tr><td><literal>17-1E</literal></td><td>該当なし</td></tr>
					<tr><td><literal>1F</literal></td><td>無属性</td></tr>
				</tbody>
			</table>
			<para>
				ちなみに、この並びはドラクエ7 のモンスターデバッガの呪文耐性リストと同じ順序だ。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>まじんのかなづちフラグ</glossterm>
		<glossdef>
			<para>
				「まじんのかなづち」装備状態でこの行動をとるときに、
				攻撃ミスになる可能性があるものについては <literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>対象が複数フラグ</glossterm>
		<glossdef>
			<para>
				行動の対象が一人のキャラクターだけにとどまらないものについては
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>ドラゴンキラー等有効フラグ</glossterm>
		<glossdef>
			<para>
				「ドラゴンキラー」「はやぶさのけん」「ゾンビキラー」装備時に、
				それらの武器特有のダメージ補正処理を行う行動であれば
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>どくばり有効フラグ</glossterm>
		<glossdef>
			<para>
				「どくばり」装備キャラクターがこの行動をとるときに、
				「どくばり」の影響があるものについては
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>特殊武器装備有効フラグ</glossterm>
		<glossdef>
			<para>
				「ゆうわくのけん」等を装備しているキャラクターがこの行動をとるときに、
				その武器が持つ効果を活かすものについては
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>はやぶさのけん・キラーピアス有効フラグ</glossterm>
		<glossdef>
			<para>
				「はやぶさのけん」「キラーピアス」を装備しているキャラクターがこの行動をとるときに、
				二回連続してその行動を繰り返すものについては
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>追加ダメージフラグ</glossterm>
		<glossdef>
			<para>
				通常の攻撃ダメージにプラスして、付加的なダメージを与える武器
				（例：ラミアスのつるぎ）を装備しているキャラクターがこの行動をとる場合に、
				付加的ダメージの処理があるものについては
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>きせきのつるぎ有効フラグ</glossterm>
		<glossdef>
			<para>
				「きせきのつるぎ」を装備しているキャラクターがこの行動をとる場合に、
				相手方にダメージを与えたときに、自分の HP が回復する処理があるものについては
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>パラディンとして攻撃すると、敵が即死する可能性があるフラグ</glossterm>
		<glossdef>
			<para>
				キャラクターの職業がパラディンである場合にこの行動をとれば、
				行動の対象となるキャラクターが即死する可能性のあるものについては
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>アストロン有効フラグ</glossterm>
		<glossdef>
			<para>
				「アストロン」により鉄の塊になっているキャラクターに対して、
				その行動がムダになるものについては
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>かばうことが可能フラグ</glossterm>
		<glossdef>
			<para>
				「みがわり」によってかばうことが可能な行動について
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>マホカンタ・マホターン有効フラグ</glossterm>
		<glossdef>
			<para>
				「マホカンタ」「マホターン」が効いているキャラクターに対して、
				その行動が反射するものについては
				<literal>1</literal> がセットされている。
				「ひかりのドレス」「ミラーアーマー」処理もこのフラグを参照する。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>うけながし可能フラグ</glossterm>
		<glossdef>
			<para>
				「うけながし」を使用中のキャラクターに対してその行動をとった場合に、
				その行動が受け流される可能性のあるものについては
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>まねまね処理</glossterm>
		<glossdef>
			<para>
				「まねまね」使用中のキャラクターに対してこの行動をとった場合に、
				そのキャラクターがどのように対処するかを示す値だ。
				以下のように処理をすることになる。
			</para>
			<table id="table.dq6.C8C65D.retaliate" class="lighttable">
				<caption>まねまね</caption>
				<thead>
					<tr><th>値</th><th>アクション</th></tr>
				</thead>
				<tbody>
					<tr><td><literal>0</literal></td><td>無視する</td></tr>
					<tr><td><literal>1</literal></td><td>やりかえせない</td></tr>
					<tr><td><literal>2</literal></td><td>通常攻撃を返す</td></tr>
					<tr><td><literal>3</literal></td><td>やりかえす</td></tr>
				</tbody>
			</table>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>メッセージ調整</glossterm>
		<glossdef>
			<para>
				詳細は不明。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>名前を持つかフラグ</glossterm>
		<glossdef>
			<para>
				じゅもんウィンドウやとくぎウィンドウに、
				その行動の名前を表示することができるものに関しては、
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>状態異常クリア可能フラグ</glossterm>
		<glossdef>
			<para>
				メダパニやラリホーにかかったキャラクターに対してこの行動をとった場合に、
				ダメージを与えた直後に、混乱状態や睡眠状態から回復する可能性があれば
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm><varname>$C8FC9B</varname> ダメージ構造体データ ID</glossterm>
		<glossdef>
			<para>
				各戦闘行動に定義される、ダメージ構造体データの ID だ。
				なお、ダメージ構造体については、別項で解説をする予定がある。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>戦闘行動キャプションセット ID</glossterm>
		<glossdef>
			<para>
				戦闘行動を入力する際に、画面隅に表示される小ウィンドウの
				各行の文字列 ID を格納する構造体データの ID だ。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>敵を倒しても無利益フラグ</glossterm>
		<glossdef>
			<para>
				この行動が直接的な原因で、敵を戦闘の場からいなくした場合に、
				この敵の本来持つ経験値もゴールドも得られないのであれば
				<literal>1</literal> がセットされている。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>処理サブルーチン アドレス</glossterm>
		<glossdef>
			<para>
				戦闘行動の処理実装中、その行動固有の処理部分
				（言ってみれば Template Method か）
				を実装するサブルーチンのアドレスだ。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>戦闘メッセージ ID</glossterm>
		<glossdef>
			<para>
				戦闘行動中に表示する<link linkend="dq6.message.battle">戦闘メッセージ</link>の ID だ。
				<literal>#$1000</literal> 以上の値をもつ戦闘行動は、例外的な扱いを受ける。
			</para>
		</glossdef>
	</glossentry>
	<glossentry>
		<glossterm>戦闘行動の名前 文字列 ID </glossterm>
		<glossdef>
			<para>
				「じゅもん」「とくぎ」選択ウィンドウに表示する文字列の<link linkend="dq6.str.data">文字列 ID</link>
				だ。
			</para>
		</glossdef>
	</glossentry>
</glosslist>
</section> <!-- dq6.act.hack.C8C65D -->
</section> <!-- dq6.act.hack -->

<section id="dq6.act.todo">
<title>TODO リスト</title>
<para>
	当然のことながら、目標は構造体全メンバーの完全解析だ。
</para>
<itemizedlist>
	<listitem>
		<para>
			各種 <code>JSR(addr,X)</code> の持つ意味を調査する。
		</para>
	</listitem>
	<listitem>
		<para>
			構造体<literal>[03] &amp; 003Fh</literal>; <varname>$C2C25D</varname> 付近から解析する。
		</para>
	</listitem>
	<listitem>
		<para>
			構造体<literal>[04] &amp; 0007h</literal>;
			<varname>$C28BEF</varname> で参照されていて、ある配列の添え字であることは判明したが、
			役割が不明。
		</para>
	</listitem>
	<listitem>
		<para>
			構造体<literal>[04] &amp; 0080h</literal>;
			<varname>$C25D40</varname> で参照されていることは判明したが、
			複雑な処理の開始地点であるため未解析。
		</para>
	</listitem>
	<listitem>
		<para>
			構造体<literal>[06] &amp; 0003h</literal> および構造体<literal>[07] &amp; 0003h</literal>;
			それぞれ <varname>$C23AB4</varname>, <varname>$C23D54</varname> で参照されていて、
			これらは関係のあるメンバーになっている。
		</para>
	</listitem>
	<listitem>
		<para>
			構造体<literal>[06] &amp; 0080h</literal>; 参照箇所が不明。
			構造体全データを見る限り、このメンバーは未使用ではない感じがする。
		</para>
	</listitem>
	<listitem>
		<para>
			構造体<literal>[07] &amp; 0004h</literal>;
			参照箇所は <varname>$C25D0A</varname> だ。
		</para>
	</listitem>
	<listitem>
		<para>
			構造体<literal>[08] &amp; 0007h</literal> および構造体<literal>[08] &amp; 0080h</literal>;
			それぞれ <varname>$C2D2E7</varname>, <varname>$C2D2AF</varname> で参照されていて、
			これらは関係のあるメンバーになっている。
		</para>
	</listitem>
	<listitem>
		<para>
			構造体<literal>[09] &amp; 00C0h</literal>;
			サブルーチン <varname>$C92965</varname> を解析しないと進めない。
		</para>
	</listitem>
	<listitem>
		<para>
			構造体<literal>[0B] &amp; 0080h</literal>;
			周辺の意味解読が難しい。
		</para>
	</listitem>
	<listitem>
		<para>
			構造体<literal>[0E] &amp; 7FFFh</literal>; および構造体<literal>[10] &amp; 0003h;</literal>
			コードはこのメンバーを同時に参照する。
			ムラサキのひとみで顕著な値をとるようだが、詳細不明。
		</para>
	</listitem>
	<listitem>
		<para>
			構造体<literal>[10] &amp; 003Ch</literal>; 解読が難しい。
		</para>
	</listitem>
	<listitem>
		<para>
			構造体<literal>[11]</literal>; 解読が難しい。
		</para>
	</listitem>
</itemizedlist>
</section> <!-- dq6.act.todo -->
</section> <!-- dq6.act -->

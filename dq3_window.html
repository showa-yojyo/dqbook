<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>5.7. ウィンドウ解析</title>
    <link rel="stylesheet" type="text/css" href="dqbook.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="home" href="index.html" title="ドラクエ命" />
    <link rel="up" href="dq3.html" title="第 5 章 SFC 版ドラクエ 3 (1996)" />
    <link rel="prev" href="dq3_damage.html" title="5.6. ダメージ構造体解析" />
    <link rel="next" href="dq3_king.html" title="5.8. 王様解析" />
  </head>
  <body>
    <div class="navigation"><table><tr><td class="online-navigation"><a href="dq3_damage.html" title="5.6. ダメージ構造体解析"><img src="image/docbook/prev.png" alt="戻る" /></a></td><td class="online-navigation"><a href="dq3.html" title="第 5 章 SFC 版ドラクエ 3 (1996)"><img src="image/docbook/up.png" alt="上に戻る" /></a></td><td class="online-navigation"><a href="dq3_king.html" title="5.8. 王様解析"><img src="image/docbook/next.png" alt="次へ" /></a></td><td>ドラクエ命</td><td class="online-navigation"><a href="index.html" title="ドラクエ命"><img src="image/docbook/home.png" alt="ホーム" /></a></td><td class="online-navigation"><a href="" title=""><img src="image/docbook/index.png" alt="索引" /></a></td></tr></table><b class="navlabel">Previous: </b><a accesskey="p" class="sectref" href="dq3_damage.html">5.6. ダメージ構造体解析</a> <b class="navlabel">Up: </b><a accesskey="u" class="sectref" href="dq3.html">第 5 章 SFC 版ドラクエ 3 (1996)</a> <b class="navlabel">Next: </b><a accesskey="n" class="sectref" href="dq3_king.html">5.8. 王様解析</a><hr /></div>
    <div class="section">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title" style="clear: both"><a id="dq3.window"></a>5.7. ウィンドウ解析</h2>
          </div>
        </div>
      </div>
      <div class="toc">
        <dl class="toc">
          <dt>
            <span class="section">
              <a href="dq3_window.html#dq3.window.hack">5.7.1. 解析</a>
            </span>
          </dt>
          <dd>
            <dl>
              <dt>
                <span class="section">
                  <a href="dq3_window.html#dq3.window.hack.C31753">5.7.1.1. <code class="varname">$C31753</code> ウィンドウ構造体アクセスサブルーチン</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="dq3_window.html#dq3.window.hack.sr">5.7.1.2. ウィンドウ関連のサブルーチン</a>
                </span>
              </dt>
              <dt>
                <span class="section">
                  <a href="dq3_window.html#dq3.window.hack.C30000">5.7.1.3. <code class="varname">$C30000</code> ウィンドウ構造体</a>
                </span>
              </dt>
            </dl>
          </dd>
        </dl>
      </div>
      <a id="term.dq3.window" class="indexterm"></a>
      <p>
ウィンドウシステムを可能な限り解析する。
解析の初期段階でウィンドウ解析を済ませておくべきだったと記者は反省している。
というのも、逆アセンブリコードを解析する際に、
ウィンドウ表示サブルーチン呼び出しがそれと識別できると、
サブルーチンの役割が直感的に判明することが十分期待できるからだ。
</p>
      <p>
結論を先に述べると、ウィンドウ構造体のメンバー解析が非常に手こずってしまった。
未解析の各フィールドの意味は、おいおい特定していくつもりだ。
</p>
      <div class="section">
        <div class="titlepage">
          <div>
            <div>
              <h3 class="title"><a id="dq3.window.hack"></a>5.7.1. 解析</h3>
            </div>
          </div>
        </div>
        <p>
記者がその昔、<code class="literal">65816</code> コードの知識もまるでない時代に、
<acronym class="acronym">ROM</acronym> イメージをバイナリエディタでテキトーに改竄し、
偶然にウィンドウデータの格納位置を発見したのが出発点だ。
メモリ空間ベースで言うと <code class="varname">$C30000</code> からしばらくウィンドウデータだ。
アセンブリコードの解析能力が身についた現在となっては、
その構造体の内部にアクセスするコードを検査し、その様子を解釈することで、
どのようにしてウィンドウデータを扱っているのかを見ていく。
</p>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title"><a id="dq3.window.hack.C31753"></a>5.7.1.1. <code class="varname">$C31753</code> ウィンドウ構造体アクセスサブルーチン</h4>
              </div>
            </div>
          </div>
          <p>
構造体アドレス取得のために用いる汎用サブルーチン <code class="varname">$C90501</code> 呼び出しを
<acronym class="acronym">ROM</acronym> イメージからすべて抽出したリストを眺めていると、
<code class="code">00 00 C3</code> という値を「引数」として指定している箇所がただひとつあった。
そのサブルーチン呼び出しを含むのが、サブルーチン <code class="varname">$C31753</code> だ。
</p>
          <p>
サブルーチン <code class="varname">$C31753</code> のアセンブリコードを中身を解析すると
このサブルーチンだけでウィンドウ一個のすべてのメンバーデータを読み取っていることが判明した。
ここにそのサブルーチン全体のコードを示したいところだが、紙面の都合で省くことにした。
メンバー数が少なくないため、サブルーチン全体が長い。
従って、<a class="link" href="dq3_window.html#dq3.window.hack.C30000" title="5.7.1.3. $C30000 ウィンドウ構造体">構造体のメモリレイアウト</a>はすぐに解析できることになる。
所定のメモリに各メンバーデータをストアして、それだけでサブルーチンは制御を呼び出し元に戻す。
</p>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title"><a id="dq3.window.hack.sr"></a>5.7.1.2. ウィンドウ関連のサブルーチン</h4>
              </div>
            </div>
          </div>
          <p>
プログラム中に現れる、ウィンドウ関連のサブルーチン呼び出しを以下に示す。
</p>
          <div class="table">
            <a id="table.dq3.window.subroutines"></a>
            <p class="title">
              <strong>表 5.15 ウィンドウ関連のサブルーチン</strong>
            </p>
            <div class="table-contents">
              <table id="table.dq3.window.subroutines" class="lighttable">
                <thead>
                  <tr>
                    <th>サブルーチン</th>
                    <th>意味</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <code class="varname">$C3165B</code>
                    </td>
                    <td><code class="varname">A</code> レジスタが示す ID のウィンドウを表示する。</td>
                  </tr>
                  <tr>
                    <td>
                      <code class="varname">$C32251</code>
                    </td>
                    <td>「引数」に示す ID のウィンドウを表示する。<code class="literal">1</code> 個。</td>
                  </tr>
                  <tr>
                    <td>
                      <code class="varname">$C3226F</code>
                    </td>
                    <td>「引数」に示す ID のウィンドウを表示する。<code class="literal">2</code> 個。</td>
                  </tr>
                  <tr>
                    <td>
                      <code class="varname">$C32296</code>
                    </td>
                    <td>「引数」に示す ID のウィンドウを表示する。<code class="literal">3</code> 個。</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <br class="table-break" />
          <p>
サブルーチン <code class="varname">$C3165B</code> はアキュームレータにウィンドウ ID をロードしてから呼び出すと、
そのウィンドウを表示するというものだ。
以下の使用例は、ゲーム最初の性格診断実装から引用したものだ。
プレイヤーにより入力済みの「月」に基づいて、表示する「日」ウィンドウを決定する。
</p>
          <pre class="programlisting">
C9/31A3:   2288A9C1    JSR $C1A988         ■[D4][AD]    うまれた日を おしえてください。[AC]
C9/31A7:   600B
(...)
C9/31B3:   0A          ASL A               <a id="dq3.window.co.1"></a><span><img src="image/docbook/callouts/1.png" alt="1" border="0" /></span>
C9/31B4:   AA          TAX
(...)
C9/31C5:   BF8B32C9    LDA $C9328B,X       ; ウィンドウ ID の配列。以下を参照。
C9/31C9:   225B16C3    JSR $C3165B         <a id="dq3.window.co.2"></a><span><img src="image/docbook/callouts/2.png" alt="2" border="0" /></span>
(...)
; LDA $C9328B,X のためのウィンドウ ID の配列
C9/328B:   3F00  ; 1 月は 31 日まである
C9/328D:   4100  ; 2 月は 29 日まである可能性がある
C9/328F:   3F00  ; 3 月は 31 日まである
C9/3291:   4000  ; 4 月は 30 日まである
C9/3293:   3F00  ; ...
C9/3295:   4000
C9/3297:   3F00
C9/3299:   3F00
C9/329B:   4000
C9/329D:   3F00
C9/329F:   4000
C9/32A1:   3F00
</pre>
          <div class="calloutlist">
            <table border="0" summary="Callout list">
              <tr>
                <td width="5%" valign="top" align="left">
                  <p><a href="#dq3.window.co.1"><span><img src="image/docbook/callouts/1.png" alt="1" border="0" /></span></a> </p>
                </td>
                <td valign="top" align="left">
                  <p>
      プレイヤーが誕生月を選択したとすると、その月の値マイナス <code class="literal">1</code> が
      <code class="varname">A</code> レジスタに格納されている。<code class="code">X = 2A</code> により、
      その月に対応するカレンダーウィンドウをマップしてある配列
      <code class="varname">$C9328B</code> にアクセスするためのインデックスを決める。
    </p>
                  <div class="segmentedlist">
                    <div class="title">
                      <strong>
                        <span class="title">ウィンドウ ID と対応するウィンドウの中身</span>
                      </strong>
                    </div>
                    <table border="0">
                      <thead>
                        <tr class="segtitle">
                          <th>ID</th>
                          <th>Window</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr class="seglistitem">
                          <td class="seg">
                            <code class="literal">#$003F</code>
                          </td>
                          <td class="seg">なんにちうまれウィンドウ 31 日までバージョン</td>
                        </tr>
                        <tr class="seglistitem">
                          <td class="seg">
                            <code class="literal">#$0040</code>
                          </td>
                          <td class="seg">なんにちうまれウィンドウ 30 日までバージョン</td>
                        </tr>
                        <tr class="seglistitem">
                          <td class="seg">
                            <code class="literal">#$0041</code>
                          </td>
                          <td class="seg">なんにちうまれウィンドウ 29 日までバージョン</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </td>
              </tr>
              <tr>
                <td width="5%" valign="top" align="left">
                  <p><a href="#dq3.window.co.2"><span><img src="image/docbook/callouts/2.png" alt="2" border="0" /></span></a> </p>
                </td>
                <td valign="top" align="left">
                  <p>
      サブルーチン <code class="varname">$C3165B</code> 呼び出しにより、
      <code class="varname">A</code> レジスタに格納されている値をウィンドウ ID とするウィンドウを画面に表示する。
    </p>
                </td>
              </tr>
            </table>
          </div>
          <p>
サブルーチン <code class="varname">$C32251</code> は本来のリターン位置にある
<code class="literal">1</code> バイトをウィンドウ ID として解釈して、そのウィンドウを表示するというものだ。
もちろん、リターン後のプログラムカウンターの位置を適切に修正する処理も含む。
以下に、<code class="varname">$C32251</code> の使用例として、冒険の書を新規作成する処理部の抜粋を示す。
<code class="code">JSR $C32251</code> の次の <code class="literal">1</code> バイトが命令でないことに注意して読んで欲しい。
</p>
          <pre class="programlisting">
C3/BDEA:    225122C3    JSR $C32251         ■(RTL+1) ウィンドウ一枚表示
C3/BDEE:    47          ; ぼうけんのしょ（空の冒険の書のリスト）
C3/BDEF:    B06D        BCS $BE5E
C3/BDF1:    8578        STA $78
C3/BDF3:    2245C3C3    JSR $C3C345         ■名前入力関連の処理
C3/BDF7:    225122C3    JSR $C32251         ■(RTL+1) ウィンドウ一枚表示
C3/BDFB:    3A          ; 名前設定 文字リストウィンドウ
C3/BDFC:    B0EC        BCS $BDEA
C3/BDFE:    227FC3C3    JSR $C3C37F         ■名前入力関連の処理 (memmov)
C3/BE02:    226BC6C3    JSR $C3C66B         ■「ロト」テスト
C3/BE06:    900D        BCC $BE15
C3/BE08:    22D4A8C1    JSR $C1A8D4         ■あなたのなまえを いれてください。[AC]
C3/BE0C:    2901
C3/BE0E:    22F740C3    JSR $C340F7
C3/BE12:    4CF7BD      JMP $BDF7
C3/BE15:    223FEBC3    JSR $C3EB3F         ■入力が予約名かどうかチェック
C3/BE19:    B0ED        BCS $BE08
C3/BE1B:    225122C3    JSR $C32251         ■(RTL+1) ウィンドウ一枚表示
C3/BE1F:    4D          ; おとこ・おんな
C3/BE20:    B0D5        BCS $BDF7
C3/BE22:    22D5C3C3    JSR $C3C3D5         ■a = (a == #$0063 ? 0 : 1)
C3/BE26:    8D5F40      STA $405F
C3/BE29:    A90B00      LDA #$000B
C3/BE2C:    8D6140      STA $4061
C3/BE2F:    A90300      LDA #$0003
C3/BE32:    8DBA33      STA $33BA
C3/BE35:    225122C3    JSR $C32251         ■(RTL+1) ウィンドウ一枚表示
C3/BE39:    4A          ; ひょうじそくど
C3/BE3A:    B0DF        BCS $BE1B
C3/BE3C:    8D6740      STA $4067
C3/BE3F:    A96100      LDA #$0061
C3/BE42:    8DBA33      STA $33BA
C3/BE45:    225122C3    JSR $C32251         ■(RTL+1) ウィンドウ一枚表示
C3/BE49:    4B          ; ステレオ・モノラル
</pre>
          <p>
サブルーチン <code class="varname">$C3226F</code>, <code class="varname">$C32296</code> は上述サブルーチン <code class="varname">$C32251</code> の複数枚バージョンだ。
それぞれ <code class="literal">1</code> バイト * <code class="literal">2</code>, 
<code class="literal">1</code> バイト * <code class="literal">3</code> をウィンドウ ID の配列としてコード中に埋め込み、
それらのウィンドウを同時に表示するというものだ。
</p>
          <p>
ここで挙げたサブルーチンはすべて「ウィンドウを表示する」ものだが、
逆にウィンドウ ID を指定して「ウィンドウを消去する」サブルーチンが別に存在する。
</p>
        </div>
        <div class="section">
          <div class="titlepage">
            <div>
              <div>
                <h4 class="title"><a id="dq3.window.hack.C30000"></a>5.7.1.3. <code class="varname">$C30000</code> ウィンドウ構造体</h4>
              </div>
            </div>
          </div>
          <p>
アドレス <code class="varname">$C30000</code> からすべてのウィンドウ構造体データが定義されている。
構造体オブジェクトひとつが占めるデータサイズは <code class="literal">#$000C</code> バイトだ。
ウィンドウオブジェクトが <code class="literal">#$00C0</code> 個配列されている。
いつものように ID がゼロのオブジェクトはダミーだ。
</p>
          <p>
ウィンドウ構造体のメモリレイアウトは以下のようになっている。
"..." となっている部分は、データフィールドがバイト境界をまたぐことを示す。
</p>
          <p>
ここはまだ書きかけだ。
</p>
          <div class="table">
            <a id="table.dq3.C30000"></a>
            <p class="title">
              <strong>表 5.16 $C30000 ウィンドウ構造体</strong>
            </p>
            <div class="table-contents">
              <table id="table.dq3.C30000" class="memorylayout">
                <colgroup>
		<col width="12%" />
		<col span="7" width="11%" />
	</colgroup>
                <thead>
                  <tr><th>Byte:Bit</th>
			<th>80</th>
			<th>40</th>
			<th>20</th>
			<th>10</th>
			<th>08</th>
			<th>04</th>
			<th>02</th>
			<th>01</th>
		</tr>
                </thead>
                <tbody>
                  <tr><th>00</th>
			<td colspan="3">...</td>
			<td colspan="5">X 座標</td>
		</tr>
                  <tr><th>01</th>
			<td>...</td>
			<td colspan="5">幅</td>
			<td colspan="2">Y 座標</td>
		</tr>
                  <tr><th>02</th>
			<td colspan="2"><code class="code">JSR ($3BB7,X)</code></td>
			<td colspan="2"><code class="code">JSR ($1ACC,X)</code></td>
			<td colspan="4">高さ</td>
		</tr>
                  <tr><th>03</th>
			<td><code class="code">$2A40 | #$1000</code></td>
			<td><code class="code">$2A40 | #$0100</code></td>
			<td colspan="2">カーソルタイプ</td>
			<td colspan="4">カーソル位置保存処理</td>
		</tr>
                  <tr><th>04</th>
			<td><code class="code">$2A40 | #$4000</code></td>
			<td>効果音</td>
			<td><code class="code">$2A40 | #$0400</code></td>
			<td colspan="4">最大項目数</td>
			<td><code class="code">$2A40 | #$0200</code></td>
		</tr>
                  <tr><th>05</th>
			<td colspan="5"><code class="code">JSR ($41D3,X)</code></td>
			<td colspan="3"><code class="varname">$28A8,X</code></td>
		</tr>
                  <tr><th>06</th>
			<td colspan="8">サブウィンドウ ID <code class="code">[0]</code></td>
		</tr>
                  <tr><th>07</th>
			<td colspan="8">サブウィンドウ ID <code class="code">[1]</code></td>
		</tr>
                  <tr><th>08</th>
			<td colspan="8">サブウィンドウ ID <code class="code">[2]</code></td>
		</tr>
                  <tr><th>09</th>
			<td colspan="8" rowspan="2">描画ルーチン</td>
		</tr>
                  <tr><th>0A</th>
		</tr>
                  <tr><th>0B</th>
			<td colspan="8"><code class="varname">$29C8,X</code></td>
		</tr>
                </tbody>
              </table>
            </div>
          </div>
          <br class="table-break" />
          <div class="variablelist">
            <dl class="variablelist">
              <dt>
                <span class="term">X 座標</span>
              </dt>
              <dd>
                <p>
			そのウィンドウが収まる最小矩形の左上頂点の X 座標だ。
			座標系はスクリーン座標系だが、単位はピクセルではないようだ。
		</p>
              </dd>
              <dt>
                <span class="term">Y 座標</span>
              </dt>
              <dd>
                <p>
			上述「X 座標」フィールドの Y バージョンだ。
		</p>
              </dd>
              <dt>
                <span class="term">幅</span>
              </dt>
              <dd>
                <p>
			そのウィンドウが収まる最小矩形の、X 軸に平行な辺の長さだ。
			単位はピクセルではない。
		</p>
              </dd>
              <dt>
                <span class="term">高さ</span>
              </dt>
              <dd>
                <p>
			上述「幅」フィールドの高さバージョンだ。
		</p>
              </dd>
              <dt>
                <span class="term">
                  <code class="code">JSR ($1ACC,X)</code>
                </span>
              </dt>
              <dd>
                <p>
			サブルーチンテーブル <code class="varname">$C31ACC</code> のインデックスだ。
		</p>
                <div class="table">
                  <a id="table.dq3.C31ACC"></a>
                  <p class="title">
                    <strong>表 5.17 JSR ($1ACC,X)</strong>
                  </p>
                  <div class="table-contents">
                    <table id="table.dq3.C31ACC" class="lighttable">
                      <thead>
                        <tr>
                          <th>値</th>
                          <th>処理</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <code class="literal">0</code>
                          </td>
                          <td>
                            <code class="code">$29B0,Y = $33B8; $2998,Y = $33BA</code>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <code class="literal">1</code>
                          </td>
                          <td rowspan="2">
                            <code class="code">$2998,Y = $33B8; $29B0,Y = $33BA</code>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <code class="literal">2</code>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <code class="literal">3</code>
                          </td>
                          <td>何もしない</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <br class="table-break" />
              </dd>
              <dt>
                <span class="term">
                  <code class="code">JSR ($3BB7,X)</code>
                </span>
              </dt>
              <dd>
                <p>
			サブルーチンテーブル <code class="varname">$C33BB7</code> のインデックスだ。
			<code class="varname">$33BC</code>, <code class="varname">$33BE</code> のセットする値の決め方に影響する。
			おそらくウィンド表示直後のカーソル位置を決めるサブルーチンなのではないかと思う。
		</p>
                <div class="table">
                  <a id="table.dq3.C33BB7"></a>
                  <p class="title">
                    <strong>表 5.18 JSR ($3BB7,X)</strong>
                  </p>
                  <div class="table-contents">
                    <table id="table.dq3.C33BB7" class="lighttable">
                      <thead>
                        <tr>
                          <th>値</th>
                          <th>処理</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <code class="literal">0</code>
                          </td>
                          <td><code class="varname">$33BC</code> と <code class="varname">$33BE</code> を何かの計算結果とする</td>
                        </tr>
                        <tr>
                          <td>
                            <code class="literal">1</code>
                          </td>
                          <td>上述 <code class="literal">0</code> における <code class="varname">$33BC</code> と <code class="varname">$33BE</code> を入れ替えた処理 </td>
                        </tr>
                        <tr>
                          <td>
                            <code class="literal">2</code>
                          </td>
                          <td>
                            <code class="code">$33BC = $2998,Y; $33BE = $29B0,Y</code>
                          </td>
                        </tr>
                        <tr>
                          <td>
                            <code class="literal">3</code>
                          </td>
                          <td>何もしない</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <br class="table-break" />
              </dd>
              <dt>
                <span class="term">カーソル位置保存処理</span>
              </dt>
              <dd>
                <p>
			サブルーチンテーブル <code class="varname">$C33BBF</code> のインデックスだ。
			プレイヤーがウィンドウでの項目選択を行った直後に呼び出されるサブルーチンであり、
			ここで、カーソル位置を特定のアドレスにセーブする。
		</p>
              </dd>
              <dt>
                <span class="term">カーソルタイプ</span>
              </dt>
              <dd>
                <p>
			ウィンドウが持つカーソルの種類を示す値だ。
		</p>
                <div class="table">
                  <a id="table.dq3.window.cursor"></a>
                  <p class="title">
                    <strong>表 5.19 カーソルタイプ</strong>
                  </p>
                  <div class="table-contents">
                    <table id="table.dq3.window.cursor" class="lighttable">
                      <thead>
                        <tr>
                          <th>値</th>
                          <th>カーソル</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          <td>
                            <code class="literal">0</code>
                          </td>
                          <td>カーソルを持たない</td>
                        </tr>
                        <tr>
                          <td>
                            <code class="literal">1</code>
                          </td>
                          <td>カーソルを持つ</td>
                        </tr>
                        <tr>
                          <td>
                            <code class="literal">2</code>
                          </td>
                          <td>＊マークが文字上を動くタイプのカーソルを持つ</td>
                        </tr>
                        <tr>
                          <td>
                            <code class="literal">3</code>
                          </td>
                          <td><code class="literal">0</code> と似ている</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
                <br class="table-break" />
              </dd>
              <dt>
                <span class="term">
                  <code class="code">$2A40 | #$0100</code>
                </span>
              </dt>
              <dd>
                <p>
			To be written.
		</p>
              </dd>
              <dt>
                <span class="term">
                  <code class="code">$2A40 | #$1000</code>
                </span>
              </dt>
              <dd>
                <p>
			To be written.
		</p>
              </dd>
              <dt>
                <span class="term">
                  <code class="code">$2A40 | #$0200</code>
                </span>
              </dt>
              <dd>
                <p>
			To be written.
		</p>
              </dd>
              <dt>
                <span class="term">最大項目数</span>
              </dt>
              <dd>
                <p>
			ウィンドウの 1 ページにある項目の数の最大値だ。
			カーソル位置保存サブルーチンが、
			選択項目のカーソル位置が（場合によってはページをまたぐので）
			最初の項目から何番目に相当するのかを計算するために用いる。
		</p>
              </dd>
              <dt>
                <span class="term">
                  <code class="code">$2A40 | #$0400</code>
                </span>
              </dt>
              <dd>
                <p>
			To be written.
		</p>
              </dd>
              <dt>
                <span class="term">効果音</span>
              </dt>
              <dd>
                <p>
			ウィンドウ表示時に効果音 (ID: <code class="literal">#$0050</code>) を鳴らすか否かを表す。
			これが <code class="literal">1</code> である代表的なものは
			「はい・いいえ」ウィンドウだ。
		</p>
              </dd>
              <dt>
                <span class="term">
                  <code class="code">$2A40 | #$4000</code>
                </span>
              </dt>
              <dd>
                <p>
			To be written.
		</p>
              </dd>
              <dt>
                <span class="term">
                  <code class="varname">$28A8,X</code>
                </span>
              </dt>
              <dd>
                <p>
			To be written.
		</p>
              </dd>
              <dt>
                <span class="term">
                  <code class="code">JSR ($41D3,X)</code>
                </span>
              </dt>
              <dd>
                <p>
			サブルーチンテーブル <code class="varname">$C341D3</code> のインデックスだ。
			他のサブルーチンテーブルにも、この値がインデックスとして用いられている。
		</p>
              </dd>
              <dt>
                <span class="term">サブウィンドウ ID</span>
              </dt>
              <dd>
                <p>
			このウィンドウと同時に表示する他のウィンドウの ID だ。
			一度に複数の<a class="link" href="dq3_window.html#dq3.window.hack.sr" title="5.7.1.2. ウィンドウ関連のサブルーチン">ウィンドウを表示するためのサブルーチン</a>が存在するが、
			それと混同してはならない。
		</p>
              </dd>
              <dt>
                <span class="term">描画ルーチン</span>
              </dt>
              <dd>
                <p>
			このウィンドウの中身を、つまり項目とそれらの並び方を決めるサブルーチンのアドレスだ。
		</p>
              </dd>
              <dt>
                <span class="term">
                  <code class="varname">$29C8,X</code>
                </span>
              </dt>
              <dd>
                <p>
			不明。
			すべてのウィンドウデータは、
			このフィールドが <code class="literal">0</code> なので実質未使用とみなせる。
		</p>
              </dd>
            </dl>
          </div>
        </div>
      </div>
    </div>
    <div class="navigation"><hr /><table><tr><td class="online-navigation"><a href="dq3_damage.html" title="5.6. ダメージ構造体解析"><img src="image/docbook/prev.png" alt="戻る" /></a></td><td class="online-navigation"><a href="dq3.html" title="第 5 章 SFC 版ドラクエ 3 (1996)"><img src="image/docbook/up.png" alt="上に戻る" /></a></td><td class="online-navigation"><a href="dq3_king.html" title="5.8. 王様解析"><img src="image/docbook/next.png" alt="次へ" /></a></td><td>ドラクエ命</td><td class="online-navigation"><a href="index.html" title="ドラクエ命"><img src="image/docbook/home.png" alt="ホーム" /></a></td><td class="online-navigation"><a href="" title=""><img src="image/docbook/index.png" alt="索引" /></a></td></tr></table><b class="navlabel">Previous: </b><a accesskey="p" class="sectref" href="dq3_damage.html">5.6. ダメージ構造体解析</a> <b class="navlabel">Up: </b><a accesskey="u" class="sectref" href="dq3.html">第 5 章 SFC 版ドラクエ 3 (1996)</a> <b class="navlabel">Next: </b><a accesskey="n" class="sectref" href="dq3_king.html">5.8. 王様解析</a></div>
  </body>
</html>
